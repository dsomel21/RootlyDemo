<%# Live Slack notification overlay â€“ BEM styled %>
<style>
/* Live Slack Notification Component - BEM Styled */

/* ==========================================================================
   Block: live-slack-notification
   ========================================================================== */

.live-slack-notification {
  /* hidden md:block pointer-events-auto */
  display: none;
  pointer-events: auto;
}

@media (min-width: 48rem) {
  .live-slack-notification {
    display: block;
  }
}

/* ==========================================================================
   Element: live-slack-notification__card
   ========================================================================== */

.live-slack-notification__card {
  /* invisible opacity-0 absolute z-20 select-none */
  visibility: hidden;
  opacity: 0;
  position: absolute;
  z-index: 20;
  user-select: none;
  
  /* rounded-2xl border border-white/12 */
  border-radius: 1rem;
  border: 1px solid rgba(255, 255, 255, 0.12);
  
  /* bg-black/75 backdrop-blur-md */
  background-color: rgba(0, 0, 0, 0.75);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  
  /* shadow-[0_10px_28px_rgba(0,0,0,0.40)] */
  box-shadow: 0 10px 28px rgba(0, 0, 0, 0.40);
  
  /* [background-image:linear-gradient(180deg,rgba(255,255,255,0.04),rgba(255,255,255,0)_30%)] */
  background-image: linear-gradient(180deg, rgba(255, 255, 255, 0.04), rgba(255, 255, 255, 0) 30%);
  
  /* will-change-transform will-change-opacity */
  will-change: transform, opacity;
  
  /* flex items-start gap-2.5 p-3 max-w-[480px] */
  display: flex;
  align-items: flex-start;
  gap: 0.625rem; /* 2.5 * 0.25rem */
  padding: 0.75rem; /* 3 * 0.25rem */
  max-width: 480px;
  
  /* cursor-pointer hover:bg-black/80 transition-colors duration-200 */
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.live-slack-notification__card:hover {
  background-color: rgba(0, 0, 0, 0.8);
}

/* ==========================================================================
   Element: live-slack-notification__avatar
   ========================================================================== */

.live-slack-notification__avatar {
  /* h-8 w-8 rounded-full object-cover flex-shrink-0 ring-1 ring-white/10 */
  height: 2rem; /* 8 * 0.25rem */
  width: 2rem; /* 8 * 0.25rem */
  border-radius: 50%;
  object-fit: cover;
  flex-shrink: 0;
  box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.1);
}

/* ==========================================================================
   Element: live-slack-notification__content
   ========================================================================== */

.live-slack-notification__content {
  /* min-w-0 flex-1 */
  min-width: 0;
  flex: 1;
}

/* ==========================================================================
   Element: live-slack-notification__header
   ========================================================================== */

.live-slack-notification__header {
  /* flex items-baseline justify-between */
  display: flex;
  align-items: baseline;
  justify-content: space-between;
}

/* ==========================================================================
   Element: live-slack-notification__author
   ========================================================================== */

.live-slack-notification__author {
  /* font-medium text-[13px] truncate */
  font-weight: 500;
  font-size: 13px;
  color: #E6E6E6;
  text-overflow: ellipsis;
  white-space: nowrap;
  overflow: hidden;
}

/* ==========================================================================
   Element: live-slack-notification__time
   ========================================================================== */

.live-slack-notification__time {
  /* text-[12px] ml-3 flex-shrink-0 */
  font-size: 12px;
  color: #8A8A8A;
  margin-left: 0.75rem; /* 3 * 0.25rem */
  flex-shrink: 0;
}

/* ==========================================================================
   Element: live-slack-notification__text
   ========================================================================== */

.live-slack-notification__text {
  /* text-[14px] leading-snug line-clamp-2 mt-1.5 */
  font-size: 14px;
  line-height: 1.375; /* leading-snug */
  color: #D4D4D4;
  margin-top: 0.375rem; /* 1.5 * 0.25rem */
  
  /* line-clamp-2 */
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* ==========================================================================
   Animation Keyframes
   ========================================================================== */

@keyframes ls-fade-in {
  0% {
    opacity: 0;
    transform: scale(0.98);
    filter: brightness(0.98);
  }
  100% {
    opacity: 1;
    transform: scale(1);
    filter: brightness(1);
  }
}

@keyframes ls-emphasize {
  0%, 100% {
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.35);
  }
  50% {
    box-shadow: 0 10px 28px rgba(0, 0, 0, 0.4), 0 0 24px rgba(255, 70, 70, 0.08);
  }
}

@keyframes ls-fade-out {
  0% {
    opacity: 1;
    transform: scale(1);
  }
  100% {
    opacity: 0;
    transform: scale(0.985);
  }
}

/* ==========================================================================
   Animation Utility Classes
   ========================================================================== */

.ls-anim-in {
  animation: ls-fade-in 320ms cubic-bezier(0.22, 1, 0.36, 1) forwards;
}

.ls-anim-pulse {
  animation: ls-emphasize 900ms ease-in-out 1;
}

.ls-anim-out {
  animation: ls-fade-out 260ms cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

/* ==========================================================================
   Reduced Motion Support
   ========================================================================== */

@media (prefers-reduced-motion: reduce) {
  .ls-anim-in,
  .ls-anim-pulse,
  .ls-anim-out {
    animation: none !important;
  }
  
  .ls-anim-in {
    opacity: 1 !important;
    transform: scale(1) !important;
  }
  
  .ls-anim-out {
    opacity: 0 !important;
    transform: scale(1) !important;
  }
}
</style>

<div 
  class="live-slack-notification"
  data-controller="live-slack"
  data-live-slack-incident-id-value="<%= @incident_id %>"
  data-live-slack-state-value="idle"
  aria-live="polite"
  aria-atomic="true"
>
  <div
    data-live-slack-target="card"
    class="live-slack-notification__card"
    style="top: <%= @top_px %>; right: <%= @right_px %>;"
    role="status"
    data-action="click->live-slack#openMessage"
  >
    <img
      data-live-slack-target="avatar"
      alt=""
      class="live-slack-notification__avatar"
    />

    <div class="live-slack-notification__content">
      <div class="live-slack-notification__header">
        <span
          data-live-slack-target="author"
          class="live-slack-notification__author"
        ></span>
        <span
          data-live-slack-target="time"
          class="live-slack-notification__time"
        ></span>
      </div>

      <div
        data-live-slack-target="text"
        class="live-slack-notification__text"
      ></div>
    </div>
  </div>
</div>
